(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){

var ko = require('knockout');
var inherits = require('util').inherits;
var components = require('ungit-components');
var Promise = require('bluebird');
var programEvents = require('ungit-program-events');

components.register('formdialog', function(args) {
  return new FormDialogViewModel(args.title);
});

components.register('credentialsdialog', function(args) {
  return new CredentialsDialogViewModel({remote: args.remote});
});

components.register('addremotedialog', function(args) {
  return new AddRemoteDialogViewModel();
});

components.register('addsubmoduledialog', function(args) {
  return new AddSubmoduleDialogViewModel();
});

components.register('promptdialog', function(args) {
  return new PromptDialogViewModel(args.title, args.details);
});

components.register('yesnodialog', function(args) {
  return new YesNoDialogViewModel(args.title, args.details);
});

components.register('yesnomutedialog', function(args) {
  return new YesNoMuteDialogViewModel(args.title, args.details);
});

components.register('toomanyfilesdialogviewmodel', function(args) {
  return new TooManyFilesDialogViewModel(args.title, args.details);
});

components.register('texteditdialog', function(args) {
  return new TextEditDialog(args.title, args.content);
});

function DialogViewModel(title) {
  var self = this;
  this.onclose = null;
  this.title = ko.observable(title);
  this.taDialogName = ko.observable('');
  this.closePromise = new Promise(function(resolve) {
    self.onclose = resolve;
  });
}
DialogViewModel.prototype.closeThen = function(thenFunc) {
  this.closePromise = this.closePromise.then(thenFunc);
  return this;
}
DialogViewModel.prototype.setCloser = function(closer) {
  this.close = closer;
}
DialogViewModel.prototype.show = function() {
  programEvents.dispatch({ event: 'request-show-dialog', dialog: this });
  return this;
}

function FormDialogViewModel(title) {
  DialogViewModel.call(this, title);
  this.items = ko.observable([]);
  this.isSubmitted = ko.observable(false);
  this.showCancel = ko.observable(true);
}
inherits(FormDialogViewModel, DialogViewModel);
FormDialogViewModel.prototype.template = 'formDialog';
FormDialogViewModel.prototype.submit = function() {
  this.isSubmitted(true);
  this.close();
}


function CredentialsDialogViewModel(args) {
  FormDialogViewModel.call(this);
  this.title(`Remote ${args.remote} requires authentication`);
  this.taDialogName('credentials-dialog');
  this.showCancel(false);
  this.username = ko.observable();
  this.password = ko.observable();
  this.items([
    { name: 'Username', value: this.username, placeholder: 'Username', type: 'text', autofocus: true, taName: 'username' },
    { name: 'Password', value: this.password, placeholder: 'Password', type: 'password', autofocus: false, taName: 'password' }
  ]);
}
inherits(CredentialsDialogViewModel, FormDialogViewModel);


function AddRemoteDialogViewModel() {
  FormDialogViewModel.call(this);
  this.title('Add new remote');
  this.taDialogName('add-remote');
  this.name = ko.observable();
  this.url = ko.observable();
  this.items([
    { name: 'Name', value: this.name, placeholder: 'Name', type: 'text', autofocus: true, taName: 'name' },
    { name: 'Url', value: this.url, placeholder: 'Url', type: 'text', autofocus: false, taName: 'url' }
  ]);
}
inherits(AddRemoteDialogViewModel, FormDialogViewModel);

function AddSubmoduleDialogViewModel() {
  FormDialogViewModel.call(this);
  this.title('Add new submodule');
  this.taDialogName('add-submodule');
  this.path = ko.observable();
  this.url = ko.observable();
  this.items([
    { name: 'Path', value: this.path, placeholder: 'Path', type: 'text', autofocus: true, taName: 'path' },
    { name: 'Url', value: this.url, placeholder: 'Url', type: 'text', autofocus: false, taName: 'url' }
  ]);
}
inherits(AddSubmoduleDialogViewModel, FormDialogViewModel);

function PromptDialogViewModel(title, details) {
  DialogViewModel.call(this, title);
  this.alternatives = ko.observable();
  this.details = ko.observable(details);
}
inherits(PromptDialogViewModel, DialogViewModel);
PromptDialogViewModel.prototype.template = 'prompt';

function YesNoDialogViewModel(title, details) {
  PromptDialogViewModel.call(this, title, details);
  var self = this;
  this.taDialogName('yes-no-dialog');
  this.result = ko.observable(false);
  this.alternatives([
    { label: 'Yes', primary: true, taId: 'yes', click: function() { self.result(true); self.close(); } },
    { label: 'No', primary: false, taId: 'no', click: function() { self.result(false); self.close(); } },
  ]);
}
inherits(YesNoDialogViewModel, PromptDialogViewModel);

function YesNoMuteDialogViewModel(title, details) {
  PromptDialogViewModel.call(this, title, details);
  var self = this;
  this.taDialogName('yes-no-mute-dialog');
  this.result = ko.observable(false);
  this.alternatives([
    { label: 'Yes', primary: true, taId: 'yes', click: function() { self.result(true); self.close(); } },
    { label: 'Yes and mute for awhile', primary: false, taId: 'mute', click: function() { self.result("mute"); self.close(); } },
    { label: 'No', primary: false, taId: 'no', click: function() { self.result(false); self.close(); } }
  ]);
}
inherits(YesNoMuteDialogViewModel, PromptDialogViewModel);

function TooManyFilesDialogViewModel(title, details) {
  PromptDialogViewModel.call(this, title, details);
  var self = this;
  this.taDialogName('yes-no-dialog');
  this.result = ko.observable(false);
  this.alternatives([
    { label: "Don't load", primary: true, taId: 'noLoad', click: function() { self.result(false); self.close(); } },
    { label: 'Load anyway', primary: false, taId: 'loadAnyway', click: function() { self.result(true); self.close(); } },
  ]);
}
inherits(TooManyFilesDialogViewModel, PromptDialogViewModel);

function TextEditDialog(title, content) {
  PromptDialogViewModel.call(this, title, `<textarea class="text-area-content" rows="30" cols="75" style="height:250px;width: 100%">${content}</textarea>`);
  var self = this;
  this.taDialogName('text-edit-dialog');
  this.result = ko.observable(false);
  this.alternatives([
    { label: "Save", primary: true, taId: 'save', click: function() {
        self.textAreaContent = document.querySelector('.modal-body .text-area-content').value;
        self.result(true);
        self.close();
      }
    },
    { label: 'Cancel', primary: false, taId: 'cancel', click: function() { self.result(false); self.close(); } },
  ]);
}
inherits(TextEditDialog, PromptDialogViewModel);

},{"bluebird":undefined,"knockout":"knockout","ungit-components":"ungit-components","ungit-program-events":"ungit-program-events","util":undefined}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJjb21wb25lbnRzL2RpYWxvZ3MvZGlhbG9ncy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiXG52YXIga28gPSByZXF1aXJlKCdrbm9ja291dCcpO1xudmFyIGluaGVyaXRzID0gcmVxdWlyZSgndXRpbCcpLmluaGVyaXRzO1xudmFyIGNvbXBvbmVudHMgPSByZXF1aXJlKCd1bmdpdC1jb21wb25lbnRzJyk7XG52YXIgUHJvbWlzZSA9IHJlcXVpcmUoJ2JsdWViaXJkJyk7XG52YXIgcHJvZ3JhbUV2ZW50cyA9IHJlcXVpcmUoJ3VuZ2l0LXByb2dyYW0tZXZlbnRzJyk7XG5cbmNvbXBvbmVudHMucmVnaXN0ZXIoJ2Zvcm1kaWFsb2cnLCBmdW5jdGlvbihhcmdzKSB7XG4gIHJldHVybiBuZXcgRm9ybURpYWxvZ1ZpZXdNb2RlbChhcmdzLnRpdGxlKTtcbn0pO1xuXG5jb21wb25lbnRzLnJlZ2lzdGVyKCdjcmVkZW50aWFsc2RpYWxvZycsIGZ1bmN0aW9uKGFyZ3MpIHtcbiAgcmV0dXJuIG5ldyBDcmVkZW50aWFsc0RpYWxvZ1ZpZXdNb2RlbCh7cmVtb3RlOiBhcmdzLnJlbW90ZX0pO1xufSk7XG5cbmNvbXBvbmVudHMucmVnaXN0ZXIoJ2FkZHJlbW90ZWRpYWxvZycsIGZ1bmN0aW9uKGFyZ3MpIHtcbiAgcmV0dXJuIG5ldyBBZGRSZW1vdGVEaWFsb2dWaWV3TW9kZWwoKTtcbn0pO1xuXG5jb21wb25lbnRzLnJlZ2lzdGVyKCdhZGRzdWJtb2R1bGVkaWFsb2cnLCBmdW5jdGlvbihhcmdzKSB7XG4gIHJldHVybiBuZXcgQWRkU3VibW9kdWxlRGlhbG9nVmlld01vZGVsKCk7XG59KTtcblxuY29tcG9uZW50cy5yZWdpc3RlcigncHJvbXB0ZGlhbG9nJywgZnVuY3Rpb24oYXJncykge1xuICByZXR1cm4gbmV3IFByb21wdERpYWxvZ1ZpZXdNb2RlbChhcmdzLnRpdGxlLCBhcmdzLmRldGFpbHMpO1xufSk7XG5cbmNvbXBvbmVudHMucmVnaXN0ZXIoJ3llc25vZGlhbG9nJywgZnVuY3Rpb24oYXJncykge1xuICByZXR1cm4gbmV3IFllc05vRGlhbG9nVmlld01vZGVsKGFyZ3MudGl0bGUsIGFyZ3MuZGV0YWlscyk7XG59KTtcblxuY29tcG9uZW50cy5yZWdpc3RlcigneWVzbm9tdXRlZGlhbG9nJywgZnVuY3Rpb24oYXJncykge1xuICByZXR1cm4gbmV3IFllc05vTXV0ZURpYWxvZ1ZpZXdNb2RlbChhcmdzLnRpdGxlLCBhcmdzLmRldGFpbHMpO1xufSk7XG5cbmNvbXBvbmVudHMucmVnaXN0ZXIoJ3Rvb21hbnlmaWxlc2RpYWxvZ3ZpZXdtb2RlbCcsIGZ1bmN0aW9uKGFyZ3MpIHtcbiAgcmV0dXJuIG5ldyBUb29NYW55RmlsZXNEaWFsb2dWaWV3TW9kZWwoYXJncy50aXRsZSwgYXJncy5kZXRhaWxzKTtcbn0pO1xuXG5jb21wb25lbnRzLnJlZ2lzdGVyKCd0ZXh0ZWRpdGRpYWxvZycsIGZ1bmN0aW9uKGFyZ3MpIHtcbiAgcmV0dXJuIG5ldyBUZXh0RWRpdERpYWxvZyhhcmdzLnRpdGxlLCBhcmdzLmNvbnRlbnQpO1xufSk7XG5cbmZ1bmN0aW9uIERpYWxvZ1ZpZXdNb2RlbCh0aXRsZSkge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHRoaXMub25jbG9zZSA9IG51bGw7XG4gIHRoaXMudGl0bGUgPSBrby5vYnNlcnZhYmxlKHRpdGxlKTtcbiAgdGhpcy50YURpYWxvZ05hbWUgPSBrby5vYnNlcnZhYmxlKCcnKTtcbiAgdGhpcy5jbG9zZVByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlKSB7XG4gICAgc2VsZi5vbmNsb3NlID0gcmVzb2x2ZTtcbiAgfSk7XG59XG5EaWFsb2dWaWV3TW9kZWwucHJvdG90eXBlLmNsb3NlVGhlbiA9IGZ1bmN0aW9uKHRoZW5GdW5jKSB7XG4gIHRoaXMuY2xvc2VQcm9taXNlID0gdGhpcy5jbG9zZVByb21pc2UudGhlbih0aGVuRnVuYyk7XG4gIHJldHVybiB0aGlzO1xufVxuRGlhbG9nVmlld01vZGVsLnByb3RvdHlwZS5zZXRDbG9zZXIgPSBmdW5jdGlvbihjbG9zZXIpIHtcbiAgdGhpcy5jbG9zZSA9IGNsb3Nlcjtcbn1cbkRpYWxvZ1ZpZXdNb2RlbC5wcm90b3R5cGUuc2hvdyA9IGZ1bmN0aW9uKCkge1xuICBwcm9ncmFtRXZlbnRzLmRpc3BhdGNoKHsgZXZlbnQ6ICdyZXF1ZXN0LXNob3ctZGlhbG9nJywgZGlhbG9nOiB0aGlzIH0pO1xuICByZXR1cm4gdGhpcztcbn1cblxuZnVuY3Rpb24gRm9ybURpYWxvZ1ZpZXdNb2RlbCh0aXRsZSkge1xuICBEaWFsb2dWaWV3TW9kZWwuY2FsbCh0aGlzLCB0aXRsZSk7XG4gIHRoaXMuaXRlbXMgPSBrby5vYnNlcnZhYmxlKFtdKTtcbiAgdGhpcy5pc1N1Ym1pdHRlZCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuICB0aGlzLnNob3dDYW5jZWwgPSBrby5vYnNlcnZhYmxlKHRydWUpO1xufVxuaW5oZXJpdHMoRm9ybURpYWxvZ1ZpZXdNb2RlbCwgRGlhbG9nVmlld01vZGVsKTtcbkZvcm1EaWFsb2dWaWV3TW9kZWwucHJvdG90eXBlLnRlbXBsYXRlID0gJ2Zvcm1EaWFsb2cnO1xuRm9ybURpYWxvZ1ZpZXdNb2RlbC5wcm90b3R5cGUuc3VibWl0ID0gZnVuY3Rpb24oKSB7XG4gIHRoaXMuaXNTdWJtaXR0ZWQodHJ1ZSk7XG4gIHRoaXMuY2xvc2UoKTtcbn1cblxuXG5mdW5jdGlvbiBDcmVkZW50aWFsc0RpYWxvZ1ZpZXdNb2RlbChhcmdzKSB7XG4gIEZvcm1EaWFsb2dWaWV3TW9kZWwuY2FsbCh0aGlzKTtcbiAgdGhpcy50aXRsZShgUmVtb3RlICR7YXJncy5yZW1vdGV9IHJlcXVpcmVzIGF1dGhlbnRpY2F0aW9uYCk7XG4gIHRoaXMudGFEaWFsb2dOYW1lKCdjcmVkZW50aWFscy1kaWFsb2cnKTtcbiAgdGhpcy5zaG93Q2FuY2VsKGZhbHNlKTtcbiAgdGhpcy51c2VybmFtZSA9IGtvLm9ic2VydmFibGUoKTtcbiAgdGhpcy5wYXNzd29yZCA9IGtvLm9ic2VydmFibGUoKTtcbiAgdGhpcy5pdGVtcyhbXG4gICAgeyBuYW1lOiAnVXNlcm5hbWUnLCB2YWx1ZTogdGhpcy51c2VybmFtZSwgcGxhY2Vob2xkZXI6ICdVc2VybmFtZScsIHR5cGU6ICd0ZXh0JywgYXV0b2ZvY3VzOiB0cnVlLCB0YU5hbWU6ICd1c2VybmFtZScgfSxcbiAgICB7IG5hbWU6ICdQYXNzd29yZCcsIHZhbHVlOiB0aGlzLnBhc3N3b3JkLCBwbGFjZWhvbGRlcjogJ1Bhc3N3b3JkJywgdHlwZTogJ3Bhc3N3b3JkJywgYXV0b2ZvY3VzOiBmYWxzZSwgdGFOYW1lOiAncGFzc3dvcmQnIH1cbiAgXSk7XG59XG5pbmhlcml0cyhDcmVkZW50aWFsc0RpYWxvZ1ZpZXdNb2RlbCwgRm9ybURpYWxvZ1ZpZXdNb2RlbCk7XG5cblxuZnVuY3Rpb24gQWRkUmVtb3RlRGlhbG9nVmlld01vZGVsKCkge1xuICBGb3JtRGlhbG9nVmlld01vZGVsLmNhbGwodGhpcyk7XG4gIHRoaXMudGl0bGUoJ0FkZCBuZXcgcmVtb3RlJyk7XG4gIHRoaXMudGFEaWFsb2dOYW1lKCdhZGQtcmVtb3RlJyk7XG4gIHRoaXMubmFtZSA9IGtvLm9ic2VydmFibGUoKTtcbiAgdGhpcy51cmwgPSBrby5vYnNlcnZhYmxlKCk7XG4gIHRoaXMuaXRlbXMoW1xuICAgIHsgbmFtZTogJ05hbWUnLCB2YWx1ZTogdGhpcy5uYW1lLCBwbGFjZWhvbGRlcjogJ05hbWUnLCB0eXBlOiAndGV4dCcsIGF1dG9mb2N1czogdHJ1ZSwgdGFOYW1lOiAnbmFtZScgfSxcbiAgICB7IG5hbWU6ICdVcmwnLCB2YWx1ZTogdGhpcy51cmwsIHBsYWNlaG9sZGVyOiAnVXJsJywgdHlwZTogJ3RleHQnLCBhdXRvZm9jdXM6IGZhbHNlLCB0YU5hbWU6ICd1cmwnIH1cbiAgXSk7XG59XG5pbmhlcml0cyhBZGRSZW1vdGVEaWFsb2dWaWV3TW9kZWwsIEZvcm1EaWFsb2dWaWV3TW9kZWwpO1xuXG5mdW5jdGlvbiBBZGRTdWJtb2R1bGVEaWFsb2dWaWV3TW9kZWwoKSB7XG4gIEZvcm1EaWFsb2dWaWV3TW9kZWwuY2FsbCh0aGlzKTtcbiAgdGhpcy50aXRsZSgnQWRkIG5ldyBzdWJtb2R1bGUnKTtcbiAgdGhpcy50YURpYWxvZ05hbWUoJ2FkZC1zdWJtb2R1bGUnKTtcbiAgdGhpcy5wYXRoID0ga28ub2JzZXJ2YWJsZSgpO1xuICB0aGlzLnVybCA9IGtvLm9ic2VydmFibGUoKTtcbiAgdGhpcy5pdGVtcyhbXG4gICAgeyBuYW1lOiAnUGF0aCcsIHZhbHVlOiB0aGlzLnBhdGgsIHBsYWNlaG9sZGVyOiAnUGF0aCcsIHR5cGU6ICd0ZXh0JywgYXV0b2ZvY3VzOiB0cnVlLCB0YU5hbWU6ICdwYXRoJyB9LFxuICAgIHsgbmFtZTogJ1VybCcsIHZhbHVlOiB0aGlzLnVybCwgcGxhY2Vob2xkZXI6ICdVcmwnLCB0eXBlOiAndGV4dCcsIGF1dG9mb2N1czogZmFsc2UsIHRhTmFtZTogJ3VybCcgfVxuICBdKTtcbn1cbmluaGVyaXRzKEFkZFN1Ym1vZHVsZURpYWxvZ1ZpZXdNb2RlbCwgRm9ybURpYWxvZ1ZpZXdNb2RlbCk7XG5cbmZ1bmN0aW9uIFByb21wdERpYWxvZ1ZpZXdNb2RlbCh0aXRsZSwgZGV0YWlscykge1xuICBEaWFsb2dWaWV3TW9kZWwuY2FsbCh0aGlzLCB0aXRsZSk7XG4gIHRoaXMuYWx0ZXJuYXRpdmVzID0ga28ub2JzZXJ2YWJsZSgpO1xuICB0aGlzLmRldGFpbHMgPSBrby5vYnNlcnZhYmxlKGRldGFpbHMpO1xufVxuaW5oZXJpdHMoUHJvbXB0RGlhbG9nVmlld01vZGVsLCBEaWFsb2dWaWV3TW9kZWwpO1xuUHJvbXB0RGlhbG9nVmlld01vZGVsLnByb3RvdHlwZS50ZW1wbGF0ZSA9ICdwcm9tcHQnO1xuXG5mdW5jdGlvbiBZZXNOb0RpYWxvZ1ZpZXdNb2RlbCh0aXRsZSwgZGV0YWlscykge1xuICBQcm9tcHREaWFsb2dWaWV3TW9kZWwuY2FsbCh0aGlzLCB0aXRsZSwgZGV0YWlscyk7XG4gIHZhciBzZWxmID0gdGhpcztcbiAgdGhpcy50YURpYWxvZ05hbWUoJ3llcy1uby1kaWFsb2cnKTtcbiAgdGhpcy5yZXN1bHQgPSBrby5vYnNlcnZhYmxlKGZhbHNlKTtcbiAgdGhpcy5hbHRlcm5hdGl2ZXMoW1xuICAgIHsgbGFiZWw6ICdZZXMnLCBwcmltYXJ5OiB0cnVlLCB0YUlkOiAneWVzJywgY2xpY2s6IGZ1bmN0aW9uKCkgeyBzZWxmLnJlc3VsdCh0cnVlKTsgc2VsZi5jbG9zZSgpOyB9IH0sXG4gICAgeyBsYWJlbDogJ05vJywgcHJpbWFyeTogZmFsc2UsIHRhSWQ6ICdubycsIGNsaWNrOiBmdW5jdGlvbigpIHsgc2VsZi5yZXN1bHQoZmFsc2UpOyBzZWxmLmNsb3NlKCk7IH0gfSxcbiAgXSk7XG59XG5pbmhlcml0cyhZZXNOb0RpYWxvZ1ZpZXdNb2RlbCwgUHJvbXB0RGlhbG9nVmlld01vZGVsKTtcblxuZnVuY3Rpb24gWWVzTm9NdXRlRGlhbG9nVmlld01vZGVsKHRpdGxlLCBkZXRhaWxzKSB7XG4gIFByb21wdERpYWxvZ1ZpZXdNb2RlbC5jYWxsKHRoaXMsIHRpdGxlLCBkZXRhaWxzKTtcbiAgdmFyIHNlbGYgPSB0aGlzO1xuICB0aGlzLnRhRGlhbG9nTmFtZSgneWVzLW5vLW11dGUtZGlhbG9nJyk7XG4gIHRoaXMucmVzdWx0ID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gIHRoaXMuYWx0ZXJuYXRpdmVzKFtcbiAgICB7IGxhYmVsOiAnWWVzJywgcHJpbWFyeTogdHJ1ZSwgdGFJZDogJ3llcycsIGNsaWNrOiBmdW5jdGlvbigpIHsgc2VsZi5yZXN1bHQodHJ1ZSk7IHNlbGYuY2xvc2UoKTsgfSB9LFxuICAgIHsgbGFiZWw6ICdZZXMgYW5kIG11dGUgZm9yIGF3aGlsZScsIHByaW1hcnk6IGZhbHNlLCB0YUlkOiAnbXV0ZScsIGNsaWNrOiBmdW5jdGlvbigpIHsgc2VsZi5yZXN1bHQoXCJtdXRlXCIpOyBzZWxmLmNsb3NlKCk7IH0gfSxcbiAgICB7IGxhYmVsOiAnTm8nLCBwcmltYXJ5OiBmYWxzZSwgdGFJZDogJ25vJywgY2xpY2s6IGZ1bmN0aW9uKCkgeyBzZWxmLnJlc3VsdChmYWxzZSk7IHNlbGYuY2xvc2UoKTsgfSB9XG4gIF0pO1xufVxuaW5oZXJpdHMoWWVzTm9NdXRlRGlhbG9nVmlld01vZGVsLCBQcm9tcHREaWFsb2dWaWV3TW9kZWwpO1xuXG5mdW5jdGlvbiBUb29NYW55RmlsZXNEaWFsb2dWaWV3TW9kZWwodGl0bGUsIGRldGFpbHMpIHtcbiAgUHJvbXB0RGlhbG9nVmlld01vZGVsLmNhbGwodGhpcywgdGl0bGUsIGRldGFpbHMpO1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHRoaXMudGFEaWFsb2dOYW1lKCd5ZXMtbm8tZGlhbG9nJyk7XG4gIHRoaXMucmVzdWx0ID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gIHRoaXMuYWx0ZXJuYXRpdmVzKFtcbiAgICB7IGxhYmVsOiBcIkRvbid0IGxvYWRcIiwgcHJpbWFyeTogdHJ1ZSwgdGFJZDogJ25vTG9hZCcsIGNsaWNrOiBmdW5jdGlvbigpIHsgc2VsZi5yZXN1bHQoZmFsc2UpOyBzZWxmLmNsb3NlKCk7IH0gfSxcbiAgICB7IGxhYmVsOiAnTG9hZCBhbnl3YXknLCBwcmltYXJ5OiBmYWxzZSwgdGFJZDogJ2xvYWRBbnl3YXknLCBjbGljazogZnVuY3Rpb24oKSB7IHNlbGYucmVzdWx0KHRydWUpOyBzZWxmLmNsb3NlKCk7IH0gfSxcbiAgXSk7XG59XG5pbmhlcml0cyhUb29NYW55RmlsZXNEaWFsb2dWaWV3TW9kZWwsIFByb21wdERpYWxvZ1ZpZXdNb2RlbCk7XG5cbmZ1bmN0aW9uIFRleHRFZGl0RGlhbG9nKHRpdGxlLCBjb250ZW50KSB7XG4gIFByb21wdERpYWxvZ1ZpZXdNb2RlbC5jYWxsKHRoaXMsIHRpdGxlLCBgPHRleHRhcmVhIGNsYXNzPVwidGV4dC1hcmVhLWNvbnRlbnRcIiByb3dzPVwiMzBcIiBjb2xzPVwiNzVcIiBzdHlsZT1cImhlaWdodDoyNTBweDt3aWR0aDogMTAwJVwiPiR7Y29udGVudH08L3RleHRhcmVhPmApO1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHRoaXMudGFEaWFsb2dOYW1lKCd0ZXh0LWVkaXQtZGlhbG9nJyk7XG4gIHRoaXMucmVzdWx0ID0ga28ub2JzZXJ2YWJsZShmYWxzZSk7XG4gIHRoaXMuYWx0ZXJuYXRpdmVzKFtcbiAgICB7IGxhYmVsOiBcIlNhdmVcIiwgcHJpbWFyeTogdHJ1ZSwgdGFJZDogJ3NhdmUnLCBjbGljazogZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlbGYudGV4dEFyZWFDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsLWJvZHkgLnRleHQtYXJlYS1jb250ZW50JykudmFsdWU7XG4gICAgICAgIHNlbGYucmVzdWx0KHRydWUpO1xuICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICB7IGxhYmVsOiAnQ2FuY2VsJywgcHJpbWFyeTogZmFsc2UsIHRhSWQ6ICdjYW5jZWwnLCBjbGljazogZnVuY3Rpb24oKSB7IHNlbGYucmVzdWx0KGZhbHNlKTsgc2VsZi5jbG9zZSgpOyB9IH0sXG4gIF0pO1xufVxuaW5oZXJpdHMoVGV4dEVkaXREaWFsb2csIFByb21wdERpYWxvZ1ZpZXdNb2RlbCk7XG4iXX0=
