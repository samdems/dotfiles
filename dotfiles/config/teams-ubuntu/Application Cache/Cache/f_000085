(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[26],{da7ead9ad1a101c39954:function(e,t,a){"use strict";a.r(t);var i=a("98bae3dbabd51089d613"),n=a("275976081ce1abf67779"),r=a("04b4c40d41a713c0c0bb"),s=a("3c0812922746c3339277"),o=a("0833b20ecbe5af2235c2"),c=a("caeea5a1a89264bf5175"),m=a("801b679406aabac77627"),d=a("e75d371903c4d34a93e5"),l=a("5fef64b3561abb2ebffa"),p=a("98da34addf7164483ddc"),v=a("447964f318fe44ff3682"),y=new v.a("isTrending"),u=new v.a("viewCount"),b=new v.a("viewerCount"),h=new v.a("activities"),g=new v.a("incompleteData"),C=a("7af6009e815f59844468"),f=a("bafd58f457f82701d60c"),_=a("d6e6a1e726db94fe6759"),A={hoverCardTitle:"file card for {0}",seeDetails:"See details",viewer:"Viewer",viewers:"Viewers",view:"View",views:"Views",apiError:"We can't show view counts right now",suggestion:"Try again later or 'See details'",unsupportMessage:"We can't show view counts for this file type",accessActivity:"viewed this",modifiedActivity:"modified this",activityTemplate:"{0} {1}",inCompleteDataMessage:"We're still getting the total count for this file",throttledMessage:"Some views and viewers came in faster than we can show",inCompleteMessage:"There are more views for this item than we're showing.",throttledStateMessage:"Views are coming in fast. Check back for updates.",spoTeachingMessage:"We can't show who viewed this item yet.",odbTeachingMessage:"Your organization prevents you from seeing viewers for this item.",trendingItem:"This item is popular with your colleagues",you:"You"},w=a("a8c7165f33a4dc07ab0d");Object(w.loadStyles)([{rawString:".msAnalyticsActivity_1de06dae{width:240px;height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.msAnalyticsActivityUserAction_1de06dae,.msAnalyticsActivityUserName_1de06dae{display:inline-block;content:attr(data-analytics-activity-start)}.msAnalyticsActivityUserName_1de06dae{content:attr(data-analytics-activity-start);color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600}.msAnalyticsActivityUserAction_1de06dae{content:attr(data-analytics-activity-end)}.msActivityItemTimeStamp_1de06dae{height:16px}\n"}]);var S=function(e){var t=e.activity,a=e.loginUserEmail,i="";"Access"===t.activityType?i=A.accessActivity:"Modified"===t.activityType&&(i=A.modifiedActivity);var r=t.actor.user.email===a?A.you:t.actor.user.displayName,s=n.createElement("div",{className:"msAnalyticsActivityUserName_1de06dae"},r),o=n.createElement("div",{className:"msAnalyticsActivityUserAction_1de06dae"},i),c=_.formatToArray(A.activityTemplate,s,o);return n.createElement(f.a,{activityPersonas:[{imageUrl:t.actor.user.image,imageAlt:t.actor.user.displayName}],activityDescription:n.createElement("div",{className:"msAnalyticsActivity_1de06dae"},c),timeStamp:t.activityDateTime})},x=a("00c764472b62222a9429"),E=a("a4ba83b4e09d44896032"),B=a("8c58b4fede749a1d44e0"),I=a("9e26cb1bc5311441daef");Object(w.loadStyles)([{rawString:".msAnalyticsStatsStats_62c00b1b,.msAnalyticsStatsStatsStatsLink_62c00b1b{padding:8px 0 4px 0;height:28px;width:100%}.msAnalyticsStatsStats_62c00b1b .ms-Link,.msAnalyticsStatsStatsStatsLink_62c00b1b .ms-Link{font-size:12px;font-weight:400;color:#333}[dir='ltr'] .msAnalyticsStatsStats_62c00b1b .ms-ActivityItem-activityTypeIcon,[dir='ltr'] .msAnalyticsStatsStatsStatsLink_62c00b1b .ms-ActivityItem-activityTypeIcon{padding-right:2px}[dir='rtl'] .msAnalyticsStatsStats_62c00b1b .ms-ActivityItem-activityTypeIcon,[dir='rtl'] .msAnalyticsStatsStatsStatsLink_62c00b1b .ms-ActivityItem-activityTypeIcon{padding-left:2px}.msAnalyticsStatsStats_62c00b1b .ms-ActivityItem-activityContent,.msAnalyticsStatsStatsStatsLink_62c00b1b .ms-ActivityItem-activityContent{font-weight:600}[dir='ltr'] .msAnalyticsStatsStats_62c00b1b .ms-ActivityItem-activityContent,[dir='ltr'] .msAnalyticsStatsStatsStatsLink_62c00b1b .ms-ActivityItem-activityContent{padding-left:8px}[dir='rtl'] .msAnalyticsStatsStats_62c00b1b .ms-ActivityItem-activityContent,[dir='rtl'] .msAnalyticsStatsStatsStatsLink_62c00b1b .ms-ActivityItem-activityContent{padding-right:8px}.msAnalyticsStatsStatsStatsLink_62c00b1b :hover{color:#0078d4}.msAnalyticsStatsViewsNoLink_62c00b1b{padding:8px 0 4px 0;font-weight:400;font-size:12px}.msAnalyticsStatsViews_62c00b1b{padding-bottom:8px}.msAnalyticsStatsViewsDivider_62c00b1b:before{content:' \\B7  '}.msAnalyticsStatsViewsDividerNoDot_62c00b1b:before{content:'   ';padding:0px 4px}.msAnalyticsStatsErrorMessage_62c00b1b{font-size:12px;font-weight:400;line-height:28px}.msFileHoverCardErrorIcon_62c00b1b{vertical-align:bottom}.msAnalyticsStatsTeachingMessage_62c00b1b,.msAnalyticsStatsInfo_62c00b1b{vertical-align:sub;padding:0px 8px}\n"}]);var F=new Date("0001-01-01T00:00:00-08:00"),D=function(e){var t=e.viewCount,a=e.viewerCount,i=e.activities,r=e.inCompleteData,s=e.onClick,c=e.withFacePile,m=e.isCompact,d=e.disableViewerCount,l=void 0===d||d,p=e.ODBOptOutViewerList,v=void 0!==p&&p;if(!t||!a)return null;if(!i||!t||!a)return n.createElement(f.a,{className:"msAnalyticsStatsStats_62c00b1b",isCompact:!0});var y=r&&r.missingDataBeforeDateTime&&new Date(r.missingDataBeforeDateTime).getTime()!==F.getTime(),u=r&&r.wasThrottled,b=y?A.inCompleteMessage:u?A.throttledStateMessage:"",h=b||(l?v?A.odbTeachingMessage:"":A.spoTeachingMessage),g=t>1?A.views:A.view,C=a>1?A.viewers:A.viewer;return m?c&&i&&0!==i.length?n.createElement(B.Link,{className:"msAnalyticsStatsStatsStatsLink_62c00b1b",onClick:s},n.createElement(f.a,{activityPersonas:0!==i.length?i.slice(0,3).map(function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}}).reverse():function(e){var t=Math.min(3,e);if(0!==t){for(var a=[],i=0;i<t;i++)a.push({imageUrl:"/_layouts/15/userphoto.aspx?size=S&accountname="});return a}}(a),activityDescriptionText:t+" "+g,isCompact:!0})):n.createElement("div",{className:"msAnalyticsStatsViewsNoLink_62c00b1b"},t+" "+g,n.createElement("span",{className:"msAnalyticsStatsViewsDividerNoDot_62c00b1b"}),a+" "+C,h&&n.createElement(I.a,{content:h},n.createElement(o.a,{className:"msAnalyticsStatsTeachingMessage_62c00b1b",iconName:"Info","aria-describedby":h}))):n.createElement("div",{className:"msAnalyticsStatsViews_62c00b1b"},a+" "+C,n.createElement("span",{className:"msAnalyticsStatsViewsDivider_62c00b1b"}),t+" "+g,b&&n.createElement(I.a,{content:b},n.createElement(o.a,{className:"msAnalyticsStatsInfo_62c00b1b",iconName:"Info","aria-describedby":b})))};D.defaultProps={withFacePile:!1},Object(w.loadStyles)([{rawString:".msAnalyticsActivityListActivity_c1be1f89{padding:8px 0}\n"}]);var T=function(e){function t(t){return e.call(this,t)||this}return i.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onLoaded&&this.props.onLoaded()},t.prototype.render=function(){return n.createElement(E.a,{size:E.b.large})},t}(n.Component),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._activities=[],t}return i.__extends(t,e),t.prototype.componentWillMount=function(){this._updateActivities(this.props)},t.prototype.componentWillUpdate=function(e){this._updateActivities(e)},t.prototype.render=function(){var e=this.props,t=e.viewCount,a=e.viewerCount,i=e.inCompleteData,r=e.activities,s=e.showAnalyticsStats,o=void 0===s||s;return t&&a&&this._activities.length>0?n.createElement("div",null,o&&n.createElement(D,{viewCount:t,viewerCount:a,activities:r,inCompleteData:i}),n.createElement(x.a,{items:this._activities,onRenderCell:this._onRenderCell})):n.createElement(T,null)},t.prototype._updateActivities=function(e){this._activities=e.activities?e.activities.map(function(e){return{activity:e,locStrings:A}}):[]},t.prototype._onRenderCell=function(e,t){return n.createElement("div",{className:"msAnalyticsActivityListActivity_c1be1f89"},n.createElement(S,{activity:e.activity,loginUserEmail:this.props.loginUserEmail}),this.props.moreActivities&&t===this._activities.length-1?n.createElement(T,{onLoaded:this.props.onLoadMoreActivities}):void 0)},i.__decorate([r.autobind],t.prototype,"_updateActivities",null),i.__decorate([r.autobind],t.prototype,"_onRenderCell",null),t}(n.Component),H=a("18db195b65a48103bb7f"),k=a("8e76061449fecef83a7d");Object(w.loadStyles)([{rawString:".msAnalyticsActionBarStats_c1bee328{min-height:28px}.msAnalyticsActionBarStats_c1bee328 .ms-Shimmer-container{margin:0}.msAnalyticsActionBarStats_c1bee328 .ms-Shimmer-container .ms-Shimmer-shimmerWrapper{top:12px}.msAnalyticsActionBarBar_c1bee328{background-color:transparent}html[dir='ltr'] .msAnalyticsActionBarBar_c1bee328 .ms-CommandBar-primaryCommands{margin-left:0px}html[dir='rtl'] .msAnalyticsActionBarBar_c1bee328 .ms-CommandBar-primaryCommands{margin-right:0px}html[dir='ltr'] .msAnalyticsActionBarBar_c1bee328 .ms-CommandBar-primaryCommands .ms-CommandBarItem:first-child{margin-left:-12px}html[dir='rtl'] .msAnalyticsActionBarBar_c1bee328 .ms-CommandBar-primaryCommands .ms-CommandBarItem:first-child{margin-right:-12px}html[dir='ltr'] .msAnalyticsActionBarBar_c1bee328 .ms-CommandBar-sideCommands{padding-right:0px}html[dir='rtl'] .msAnalyticsActionBarBar_c1bee328 .ms-CommandBar-sideCommands{padding-left:0px}html[dir='ltr'] .msAnalyticsActionBarBar_c1bee328 .ms-CommandBar-sideCommands .ms-CommandBarItem{margin-right:-8px}html[dir='rtl'] .msAnalyticsActionBarBar_c1bee328 .ms-CommandBar-sideCommands .ms-CommandBarItem{margin-left:-8px}.msAnalyticsActionBarBar_c1bee328 .ms-CommandBarItem:hover,.msAnalyticsActionBarBar_c1bee328 .ms-CommandBarItem-link:hover{background-color:transparent}.msAnalyticsActionBarBar_c1bee328 .ms-CommandBarItem:hover .ms-CommandBarItem-commandText,.msAnalyticsActionBarBar_c1bee328 .ms-CommandBarItem-link:hover .ms-CommandBarItem-commandText{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:'}.msAnalyticsActionBarBar_c1bee328 .ms-CommandBarItem-text,.msAnalyticsActionBarBar_c1bee328 .ms-CommandBarItem-commandText{font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:12px;font-weight:normal}.msAnalyticsActionBarBar_c1bee328 .ms-CommandBarItem-text,.msAnalyticsActionBarBar_c1bee328 .ms-CommandBarItem-icon,.msAnalyticsActionBarBar_c1bee328 .ms-CommandBarItem-commandText{color:'},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}\n"}]);var V=function(e){var t=e.items,a=e.farItems,r=e.analyticsStats,s=e.withFacePile,o=e.showActionBar,c=void 0===o||o,m=!(!r||!r.viewCount&&!r.isNotSupported);return n.createElement("div",null,n.createElement("div",{className:"msAnalyticsActionBarStats_c1bee328"},n.createElement(k.a,{width:s?35:50,isDataLoaded:m,lineElements:[{type:k.b.LINE,height:8}]},n.createElement(D,i.__assign({withFacePile:s,isCompact:!0},r)))),c&&n.createElement(H.a,{className:"msAnalyticsActionBarBar_c1bee328",items:t,farItems:a}))},L=[".docx",".xlsx",".pptx",".doc",".xls",".ppt",".pdf",".vsdx",".vsdm",".aspx",".vsd",".vdx",".vdw",".vss",".vssm",".vssx",".vst",".vstm",".vstx",".vtx",".vsx",".odc",".ods",".odt",".odp"],M=a("3807b29c38f48ccb67b1"),U=a("b2a4e73a199c239f2b39");function O(e){return function(t,a,i){var n=t(U.a);M.Engagement.withManager(n).logData(e)}}Object(w.loadStyles)([{rawString:'.msFileHoverCardCompactCard_88106ebc{padding:8px 24px}.msFileHoverCardCompactCardTitle_88106ebc{font-family:"Segoe UI Semilight WestEuropean","Segoe UI Semilight","Segoe UI",Tahoma,Arial,sans-serif;font-size:17px;font-weight:normal;font-weight:400;line-height:20px;padding:12px 0 8px 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msFileHoverCardCompactCardActivity_88106ebc{padding:8px 0}.msFileHoverCardExpandedCard_88106ebc{padding:0 24px}.msFileHoverCardExpandedCardSection_88106ebc{padding:10px 0;white-space:nowrap}.msFileHoverCardExpandedCardSection_88106ebc:not(:last-child){border-bottom:1px solid '},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:'}.msFileHoverCardExpandedCardLoadError_88106ebc{padding:120px 45px;font-family:"Segoe UI Regular WestEuropean","Segoe UI",Tahoma,Arial,sans-serif;font-size:14px;font-weight:normal;text-align:center;color:'},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.msFileHoverCardExpandedCardLoadError_88106ebc .msFileHoverCardExpandedCardSuggestion_88106ebc{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.msFileHoverCardExpandedCardhostScroll_88106ebc{height:calc(100% - 1px)}\n"}]);var P=a("6d69c5cabadd78126515"),R=[{key:"share",icon:"share",title:"share",onClick:function(){alert("share clicked")}}];function W(e){e&&alert("onView Click")}function j(e){e&&alert("onDetails Click")}var z=function(e){function t(t){var a=e.call(this,t)||this;return a._onCardHide=function(){a.setState({visible:!1})},a.state={visible:!1},a}return i.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,a=t.itemKey,i=t.cardDismissDelay,r=void 0===i?300:i,o=t.directionalHint,c=void 0===o?11:o,d=t.gapSpace,p=void 0===d?8:d;return n.createElement(m.a,null,function(t){var i=t.itemCache,o=0;if(e.state.visible){var m=i.demandItemFacet(l.p,a),d=m&&m.itemKey,v=i.demandItemFacet(y,d),u=i.demandItemFacet(h,d);o=e._getCardHight(v,u)}var b={onRenderCompactCard:e._onRenderCompactContent,onRenderExpandedCard:e._onRenderExpandedContent,compactCardHeight:176,expandedCardHeight:o,directionalHint:c,directionalHintFixed:!1,gapSpace:p,styles:{expandedCardScroll:"ms-FileHoverCard-expandedCard-hostScroll"}};return n.createElement(s.a,{expandingCardProps:b,expandedCardOpenDelay:1500,cardDismissDelay:r,target:e.props.target,onCardVisible:e._onCardOpen,onCardHide:e._onCardHide,trapFocus:!0})})},t.prototype._getCardHight=function(e,t){var a=t&&t.length;return Number(a)>0?340:e?40:1},t.prototype._onCardOpen=function(){O({name:"FileHoverCard.CompactCardOpen"}),this.setState({visible:!0})},t.prototype._onRenderCompactContent=function(){var e=this,t=this.props,a=t.itemKey,i=t.actionBarItems;return n.createElement(m.a,null,function(t){var r,s=t.itemCache,o=s.demandItemFacet(l.h,a),m=o&&o.name,d=o&&o.name,v=s.demandItemFacet(l.d,a),y=s.demandItemFacet(l.t,a),g=s.demandItemFacet(l.p,a),C=g&&g.itemKey,f=v?new Date(v):new Date;y&&(r=s.demandItem({displayName:l.f,email:p.a,sip:p.c,picture:p.b},y.itemKey));var w={email:r&&r.email||"",id:r&&r.sip||"",displayName:r&&r.displayName||"",image:r&&r.picture||""},x=s.demandItemFacet(P.d,P.b),E=x&&x.language||window.navigator.language,B={activityDateTime:Object(c.a)(f,E),actor:{user:w}},I=s.demandItemFacet(u,C),F=s.demandItemFacet(b,C),D=s.demandItemFacet(h,C);return n.createElement("div",{className:"msFileHoverCardCompactCard_88106ebc","aria-labelledby":"msFileHoverCardCompactCardTitle_88106ebc ms-FileHoverCard-compactCard--latestActivity"},n.createElement("div",{className:"msFileHoverCardCompactCardTitle_88106ebc",id:"ms-FileHoverCard-title","aria-label":_.format(A.hoverCardTitle,m)},m),n.createElement("div",{className:"msFileHoverCardCompactCardActivity_88106ebc",id:"ms-FileHoverCard-compactCard--latestActivity"},n.createElement(S,{activity:B,loginUserEmail:e.props.loginUserEmail})),n.createElement("div",{className:"ms-FileHoverCard-compactCard--actionBar"},i&&n.createElement(V,{analyticsStats:{viewCount:I,viewerCount:F,activities:D,onClick:e._onView,isNotSupported:!(d&&function(e){return L.indexOf(e)>-1}(d))},items:i,withFacePile:!0,farItems:[{key:"details",title:A.seeDetails,name:A.seeDetails,ariaLabel:A.seeDetails,onClick:e._onDetails}]})))})},t.prototype._onRenderExpandedContent=function(){var e=this,t=this.props.itemKey,a=Object(C.getTheme)();return n.createElement(m.a,null,function(i){var r=i.itemCache,s=r.demandItemFacet(l.p,t),o=s&&s.itemKey,c=r.demandItemFacet(u,o),m=r.demandItemFacet(b,o),d=r.demandItemFacet(y,o),p=r.demandItemFacet(h,o),v=r.demandItemFacet(g,o);return c&&m&&p?n.createElement("div",{className:"msFileHoverCardExpandedCard_88106ebc"},d&&e._getMessageSection("Market",A.trendingItem,{color:a.palette.green}),e._shouldShowActivities(p)&&n.createElement("div",{className:"msFileHoverCardExpandedCardSection_88106ebc"},n.createElement(N,{viewCount:c,viewerCount:m,isTrending:d,activities:p,inCompleteData:v,loginUserEmail:e.props.loginUserEmail}))):n.createElement("div",null)})},t.prototype._getMessageSection=function(e,t,a){return n.createElement("div",{className:"msFileHoverCardExpandedCardSection_88106ebc"},n.createElement(o.a,{iconName:e,styles:{root:Object(C.mergeStyles)([{paddingRight:"8px",position:"relative",top:"3px"},a])}}),t)},t.prototype._shouldShowActivities=function(e){var t=e&&e.length;return Number(t)>0},t.prototype._onView=function(e){O({name:"FileHoverCard.ViewCountClick"}),this.props.onView&&this.props.onView(e),e&&e.stopPropagation(),e&&e.preventDefault()},t.prototype._onDetails=function(e){O({name:"FileHoverCard.SeeDetailsClick"}),this.props.onDetails&&this.props.onDetails(e),e&&e.stopPropagation(),e&&e.preventDefault()},t.defaultProps={itemKey:"",actionBarItems:R,onView:W,onDetails:j},i.__decorate([r.autobind],t.prototype,"_getCardHight",null),i.__decorate([r.autobind],t.prototype,"_onCardOpen",null),i.__decorate([r.autobind],t.prototype,"_onRenderCompactContent",null),i.__decorate([r.autobind],t.prototype,"_onRenderExpandedContent",null),i.__decorate([r.autobind],t.prototype,"_getMessageSection",null),i.__decorate([r.autobind],t.prototype,"_shouldShowActivities",null),i.__decorate([r.autobind],t.prototype,"_onView",null),i.__decorate([r.autobind],t.prototype,"_onDetails",null),t}(n.Component),K=Object(d.c)()(z);function Z(){return function(e){var t=e;return function(e){function a(t){var a=e.call(this,t)||this;return a.state={target:null},a}return i.__extends(a,e),a.prototype.render=function(){return n.createElement("div",{className:"msHoverZone",ref:this._setTarget},this.state.target&&n.createElement(t,i.__assign({target:this.state.target},this.props)),this.props.children)},a.prototype._setTarget=function(e){this.setState({target:e})},i.__decorate([r.autobind],a.prototype,"_setTarget",null),a}(n.PureComponent)}}a.d(t,"FileHoverCardZone",function(){return J}),a.d(t,"CurrentFileHoverCardZone",function(){return Y});var J=Z()(z),Y=Z()(K)}}]);
//# sourceMappingURL=precompiled-26.min.0f6641d1d69448bbaf75.js.map